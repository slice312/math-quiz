(()=>{"use strict";const e={playerName:"",gameMode:"",score:0,level:1,correctCount:0,incorrectCount:0};!e.playerName&&window.AppState&&(e.playerName=window.AppState.playerName),window.AppState=e;const t=(e,t)=>String(e).padStart(t,"0");class n{#e;#t;#n;#o;set onTick(e){this.#e=e}set onComplete(e){this.#t=e}start(e){this.#n=e,this.#r(),this.#o=setInterval(this.#r.bind(this),1e3)}stop(){clearInterval(this.#o),this.#t?.()}#r(){this.#n<=0?this.stop():(this.#n-=1,this.#e?.(this.#n))}}const o=e=>{const t=document.getElementById("game-screen-ex-left"),n=document.getElementById("game-screen-ex-op"),o=document.getElementById("game-screen-ex-right");t.textContent=e.num1,n.textContent=e.operator,o.textContent=e.num2};class r{operators=["+","-","*"];#a;constructor(){}generateExpression(){const e=this.getRandom(1,10),t=this.getRandom(1,10),n=this.operators[this.getRandom(0,2)];return{num1:e,num2:t,operator:n,result:this.sum(e,t,n)}}getRandom(e,t){return Math.round(Math.random()*(t-e)+e)}sum(e,t,n){return"+"===n?e+t:"-"===n?e-t:e*t}}const a=()=>{const e=document.getElementById("modal-game-result"),t=document.getElementById("modal-order-container");e.style.display="block",s(),document.getElementById("btn-play-again").onclick=()=>{t.classList.add("animate__zoomOut"),t.onanimationstart=()=>{e.style.background="transparent"},t.onanimationend=()=>{e.style.display="none",t.classList.remove("animate__zoomOut"),c.navigate("./main-game-screen")}}},s=()=>{const t={level:document.getElementById("modal-game-result-level"),score:document.getElementById("modal-game-result-score"),correct:document.getElementById("modal-game-result-correct-count"),incorrect:document.getElementById("modal-game-result-incorrect-count")};t.level.textContent=String(e.level),t.score.textContent=String(e.score),t.correct.textContent=String(e.correctCount),t.incorrect.textContent=String(e.incorrectCount)},l={404:{template:"./src/templates/404.html",render:null,title:"",description:""},"/":{template:"./src/templates/main-menu.html",render:()=>{const t=document.getElementById("main-menu");document.getElementById("main-menu-btn-play").onclick=n=>{e.gameMode=t.elements.gameMode.value,e.playerName=t.elements.name.value,console.log("GLOBAL state",e),t.checkValidity()&&(n.preventDefault(),c.navigate("main-game-screen"))}},title:"",description:""},"/about":{template:"./src/templates/about.html",render:()=>{console.log("renderAboutPage")},title:"",description:""},"/main-game-screen":{template:"./src/templates/main-game-screen.html",render:()=>{document.getElementById("game-screen-player-name").textContent=e.playerName,(e=>{const o=document.getElementById("game-screen-timer-label"),r=document.getElementById("game-screen-timer-circle"),s=2*r.getAttribute("r")*Math.PI;r.setAttribute("stroke-dasharray",String(s));const l=new n;l.onTick=t=>{c(t),r.setAttribute("stroke-dashoffset",String(s*t/e-s))};const c=e=>{const n=t(Math.floor(e/60),2),r=t(e%60,2);o.textContent=`${n}:${r}`};l.onComplete=()=>{console.log("time over"),a()},l.start(e)})(115);const s=document.getElementById("game-screen-task-form");s.onsubmit=e=>e.preventDefault();const l=document.getElementById("game-screen-score-label"),c=new r;let i=c.generateExpression();o(i),e.score=0,e.correctCount=0,e.incorrectCount=0,s.onsubmit=t=>{if(t.preventDefault(),s.elements.result.value){Number(s.elements.result.value)===i.result?(e.score+=1,e.correctCount+=1):(e.score=Math.max(e.score-1,0),e.incorrectCount+=1);const t=document.getElementById("game-screen-expr-wrap");t.classList.add("animate__fadeOutLeft"),window.requestAnimationFrame((()=>{t.classList.remove("animate__fadeOutLeft"),s.elements.result.value="",i=c.generateExpression(),o(i)})),l.textContent=e.score}console.log(s.elements.result.value)}},title:"Quiz",description:""},"/leaderboard":{template:"./src/templates/leaderboard.html",render:null,title:"Leaderboard",description:""}},c=new class{#s;constructor(e){this.#s=e}init(){const e=e=>this.#l(e);window.addEventListener("popstate",e),window.addEventListener("hashchange",e),window.addEventListener("load",e)}#l(e){e.preventDefault(),window.history.pushState({},"",e.target.href),this.#c()}async#c(){const e=this.getCurrentUrlPath(),t=this.#s[e],n=await fetch(t.template).then((e=>e.text())),o=(new DOMParser).parseFromString(n,"text/html"),r=document.getElementById("root");this.#i(r);for(const e of o.body.childNodes)r.appendChild(e);t.render&&t.render()}getCurrentUrlPath(){const e=window.location.pathname;return e.indexOf("/zeon-module-2_MathQuiz")>=0?e.replace("/zeon-module-2_MathQuiz",""):e}#i=e=>{for(;e.lastChild;)e.removeChild(e.lastChild)};navigate(e){window.history.pushState({},"",e),this.#c()}}(l);class i extends HTMLElement{connectedCallback(){this.addEventListener("click",(()=>{const e=this.getAttribute("href");c.navigate(e)}),!1)}}console.log("PAGE LOADING"),document.addEventListener("DOMContentLoaded",(()=>{c.init(),window.customElements.define("app-link",i)}))})();