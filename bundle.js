(()=>{"use strict";const e={playerName:"",gameMode:"",score:0};!e.playerName&&window.AppState&&(e.playerName=window.AppState.playerName),window.AppState=e;const t=(e,t)=>String(e).padStart(t,"0");class n{#e;#t;#n;#s;set onTick(e){this.#e=e}set onComplete(e){this.#t=e}start(e){this.#n=e,this.#o(),this.#s=setInterval(this.#o.bind(this),1e3)}stop(){clearInterval(this.#s),this.#t?.()}#o(){this.#n<=0?this.stop():(this.#n-=1,this.#e?.(this.#n))}}const s=e=>{const t=document.getElementById("game-screen-ex-left"),n=document.getElementById("game-screen-ex-op"),s=document.getElementById("game-screen-ex-right");t.textContent=e.num1,n.textContent=e.operator,s.textContent=e.num2};class o{operators=["+","-","*"];#a;constructor(){}generateExpression(){const e=this.getRandom(1,10),t=this.getRandom(1,10),n=this.operators[this.getRandom(0,2)];return{num1:e,num2:t,operator:n,result:this.sum(e,t,n)}}getRandom(e,t){return Math.round(Math.random()*(t-e)+e)}sum(e,t,n){return"+"===n?e+t:"-"===n?e-t:e*t}}const a={404:{template:"/src/templates/404.html",render:null,title:"",description:""},"/":{template:"/src/templates/main-menu.html",render:()=>{const t=document.getElementById("main-menu");document.getElementById("main-menu-btn-play").onclick=n=>{e.gameMode=t.elements.gameMode.value,e.playerName=t.elements.name.value,console.log("GLOBAL state",e),t.checkValidity()&&(n.preventDefault(),r.navigate("main-game-screen"))}},title:"",description:""},"/about":{template:"/src/templates/about.html",render:()=>{console.log("renderAboutPage")},title:"",description:""},"/main-game-screen":{template:"/src/templates/main-game-screen.html",render:()=>{document.getElementById("game-screen-player-name").textContent=e.playerName,(e=>{const s=document.getElementById("game-screen-timer-label"),o=document.getElementById("game-screen-timer-circle"),a=2*o.getAttribute("r")*Math.PI;o.setAttribute("stroke-dasharray",String(a));const r=new n;r.onTick=t=>{l(t),o.setAttribute("stroke-dashoffset",String(a*t/e-a))};const l=e=>{const n=t(Math.floor(e/60),2),o=t(e%60,2);s.textContent=`${n}:${o}`};r.onComplete=()=>{console.log("time over")},r.start(e)})(121);const a=document.getElementById("game-screen-task-form");a.onsubmit=e=>e.preventDefault();const r=document.getElementById("game-screen-score-label");let l=0;const i=new o;let m=i.generateExpression();s(m),a.onsubmit=t=>{if(t.preventDefault(),a.elements.result.value){Number(a.elements.result.value)===m.result?(l+=1,e.score=l):(l=Math.max(l-1,0),e.score=l);const t=document.getElementById("game-screen-expr-wrap");t.classList.add("animate__fadeOutLeft"),window.requestAnimationFrame((()=>{t.classList.remove("animate__fadeOutLeft"),a.elements.result.value="",m=i.generateExpression(),s(m)})),r.textContent=l}console.log(a.elements.result.value)}},title:"Quiz",description:""},"/leaderboard":{template:"/src/templates/leaderboard.html",render:null,title:"Leaderboard",description:""}},r=new class{#r;constructor(e){this.#r=e}init(){const e=e=>this.#l(e);window.addEventListener("popstate",e),window.addEventListener("hashchange",e),window.addEventListener("load",e)}#l(e){e.preventDefault(),window.history.pushState({},"",e.target.href),this.#i()}async#i(){const e=this.getCurrentUrlPath(),t=this.#r[e],n=await fetch(t.template).then((e=>e.text())),s=(new DOMParser).parseFromString(n,"text/html"),o=document.getElementById("root");this.#m(o);for(const e of s.body.childNodes)o.appendChild(e);t.render&&t.render()}getCurrentUrlPath(){const e=window.location.pathname;return e.indexOf("/zeon-module-2_MathQuiz")>=0?e.replace("/zeon-module-2_MathQuiz",""):e}#m=e=>{for(;e.lastChild;)e.removeChild(e.lastChild)};navigate(e){window.history.pushState({},"",e),this.#i()}}(a);class l extends HTMLElement{connectedCallback(){this.addEventListener("click",(()=>{const e=this.getAttribute("href");r.navigate(e)}),!1)}}console.log("PAGE LOADING"),document.addEventListener("DOMContentLoaded",(()=>{r.init(),window.customElements.define("app-link",l)}))})();